# 加工依頼一覧画面詳細設計書

## 1. 概要
加工依頼データの検索・一覧表示を行う画面。
加工依頼の進捗状況を確認し、戻り入力や帳票出力などの操作を提供する。

## 2. 画面構成
### 2.1 ヘッダー部
- 画面タイトル「加工依頼一覧」を表示

### 2.2 検索条件部
#### 2.2.1 検索フォーム
- 加工依頼日（開始）：日付入力
- 加工依頼日（終了）：日付入力
- 製品ID：セレクトボックス
- 加工名：セレクトボックス
- 加工先：セレクトボックス

#### 2.2.2 操作ボタン
- 検索ボタン：条件に基づく検索実行
- クリアボタン：検索条件をリセット

### 2.3 一覧表示部
#### 2.3.1 ヘッダー部
- 件数表示：検索結果件数をバッジで表示
- PDF出力ボタン：検索結果のPDF出力

#### 2.3.2 一覧テーブル
- 依頼ID
- 加工依頼日
- 製品ID
- 依頼数量（バッジ表示）
- 加工名
- 加工先
- 戻り残数（状態に応じた色分けバッジ）
- 操作（戻り入力ボタン）

## 3. 機能詳細
### 3.1 検索機能
1. 検索条件の入力
   - 日付範囲の整合性チェック
   - マスタデータに基づく選択肢の提供
   - 条件の組み合わせによる絞り込み

2. 検索実行
   - 入力された条件に基づくデータ取得
   - 検索条件の保持（画面再表示時）
   - 検索結果の表示制御

### 3.2 一覧表示機能
1. データの表示
   - 検索結果の一覧表示
   - 件数表示
   - データ不在時のメッセージ表示

2. 状態表示
   - 数量のバッジ表示
   - 戻り残数の状態別色分け
     - 緑：戻り残数 = 0
     - 黄：戻り残数 > 0
     - 赤：その他の状態

### 3.3 PDF出力機能
- 現在の検索条件を維持したPDF出力
- 別ウィンドウでの出力
- 検索条件の引き継ぎ

### 3.4 戻り入力機能
- 未完了の加工依頼（CSHK_FLG = 0）のみ表示
- 戻り入力画面への遷移
- 加工依頼IDの引き継ぎ

## 4. イベント処理
### 4.1 日付入力制御
- 開始日変更時の終了日最小値設定
- 終了日変更時の開始日最大値設定
- 初期表示時の日付範囲制御

### 4.2 検索条件クリア
- 全検索条件のリセット
- 画面の初期状態への復帰

## 5. エラー処理
### 5.1 入力チェック
- 日付範囲の妥当性チェック
- 検索条件の組み合わせチェック

### 5.2 データ取得エラー
- 検索実行時のエラー処理
- マスタデータ取得エラーの処理

## 6. 画面遷移
### 6.1 検索実行時
- 同画面での結果表示
- 検索条件の保持

### 6.2 PDF出力時
- 別ウィンドウでのPDF表示
- 元画面は維持

### 6.3 戻り入力時
- 戻り入力画面への遷移
- 加工依頼IDの引き継ぎ

## 7. セキュリティ考慮事項
- 検索条件の入力値検証
- 不正なパラメータ操作の防止
- 権限に基づく機能制限

## 8. パフォーマンス考慮事項
- 検索条件の適切な絞り込み
- 大量データ時の表示制御
- マスタデータのキャッシュ活用

## 9. マスタデータ連携
### 9.1 製品マスタ（PRD_MST）
- 製品ID、製品名の取得
- 検索条件の選択肢として使用

### 9.2 加工マスタ（CPRC_MST）
- 加工ID、加工名の取得
- 検索条件の選択肢として使用

### 9.3 取引先マスタ（CZTR_MST）
- 取引先ID、取引先名の取得
- 加工先の選択肢として使用 